(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3054f6c8"],{"0ce5":function(t,e,n){"use strict";n("c2fb")},2423:function(t,e,n){"use strict";n.d(e,"f",(function(){return r})),n.d(e,"e",(function(){return i})),n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return o})),n.d(e,"d",(function(){return u}));var a=n("b775"),r=function(t){return Object(a["a"])({method:"GET",url:"/app/v1_1/articles",params:t})},i=function(t){return Object(a["a"])({method:"get",url:"/app/v1_0/articles/".concat(t)})},c=function(t){return Object(a["a"])({method:"POST",url:"/app/v1_0/article/collections",data:{target:t}})},s=function(t){return Object(a["a"])({url:"/app/v1_0/article/collections/".concat(t),method:"DELETE"})},o=function(t){return Object(a["a"])({method:"POSt",url:"/app/v1_0/article/likings",data:{target:t}})},u=function(t){return Object(a["a"])({method:"DELETE",url:"/app/v1_0/article/likings/".concat(t)})}},"27c1":function(t,e,n){},"351c":function(t,e,n){"use strict";n("f40a")},"4d3d":function(t,e,n){},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var a=n("1d80"),r=n("5899"),i="["+r+"]",c=RegExp("^"+i+i+"*"),s=RegExp(i+i+"*$"),o=function(t){return function(e){var n=String(a(e));return 1&t&&(n=n.replace(c,"")),2&t&&(n=n.replace(s,"")),n}};t.exports={start:o(1),end:o(2),trim:o(3)}},6009:function(t,e,n){},"655b":function(t,e,n){"use strict";n("c1ad")},"7db0":function(t,e,n){"use strict";var a=n("23e7"),r=n("b727").find,i=n("44d2"),c="find",s=!0;c in[]&&Array(1)[c]((function(){s=!1})),a({target:"Array",proto:!0,forced:s},{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),i(c)},"8ea2":function(t,e,n){"use strict";n("27c1")},a9e3:function(t,e,n){"use strict";var a=n("83ab"),r=n("da84"),i=n("94ca"),c=n("6eeb"),s=n("5135"),o=n("c6b6"),u=n("7156"),l=n("c04e"),d=n("d039"),f=n("7c73"),h=n("241c").f,p=n("06cf").f,m=n("9bf2").f,v=n("58a8").trim,b="Number",g=r[b],_=g.prototype,w=o(f(_))==b,C=function(t){var e,n,a,r,i,c,s,o,u=l(t,!1);if("string"==typeof u&&u.length>2)if(u=v(u),e=u.charCodeAt(0),43===e||45===e){if(n=u.charCodeAt(2),88===n||120===n)return NaN}else if(48===e){switch(u.charCodeAt(1)){case 66:case 98:a=2,r=49;break;case 79:case 111:a=8,r=55;break;default:return+u}for(i=u.slice(2),c=i.length,s=0;s<c;s++)if(o=i.charCodeAt(s),o<48||o>r)return NaN;return parseInt(i,a)}return+u};if(i(b,!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var E,O=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof O&&(w?d((function(){_.valueOf.call(n)})):o(n)!=b)?u(new g(C(e)),n,O):C(e)},j=a?h(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),x=0;j.length>x;x++)s(g,E=j[x])&&!s(O,E)&&m(O,E,p(g,E));O.prototype=_,_.constructor=O,c(r,b,O)}},b3d7:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home-container"},[n("home-nav-bar"),n("home-tab",{attrs:{channels:t.channels},on:{isPopup:t.isPopup}}),n("popup",{attrs:{isChannelEditShow:t.isChannelEditShow},on:{popup:t.popup}},[n("channel-edit",{attrs:{channelsEdit:t.channels},on:{close:function(e){t.isChannelEditShow=!1}}})],1)],1)},r=[],i=n("1da1"),c=n("5530"),s=(n("96cf"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home-nav-bar"},[n("van-nav-bar",{staticClass:"app-nav-bar"},[n("van-button",{staticClass:"sreach-btn",attrs:{slot:"title",icon:"search",round:"",to:"/search"},slot:"title"},[t._v("搜索")])],1)],1)}),o=[],u={name:"HomeNavBar",components:{},props:{},data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{}},l=u,d=(n("8ea2"),n("2877")),f=Object(d["a"])(l,s,o,!1,null,"b0107f24",null),h=f.exports,p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home-tab"},[n("van-tabs",{model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[t._l(t.channels,(function(t){return n("van-tab",{key:t.id,attrs:{title:t.name}},[n("article-list",{attrs:{channel:t}})],1)})),n("div",{staticClass:"zuihou",attrs:{slot:"nav-right"},slot:"nav-right"}),n("div",{staticClass:"popup",attrs:{slot:"nav-right"},on:{click:t.isPopup},slot:"nav-right"},[n("van-icon",{attrs:{name:"wap-nav"}})],1)],2)],1)},m=[],v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"article-list",staticClass:"article-list"},[n("van-pull-refresh",{attrs:{"success-text":t.refreshSuccessText,"success-duration":1200},on:{refresh:t.onRefresh},model:{value:t.isRefreshLoading,callback:function(e){t.isRefreshLoading=e},expression:"isRefreshLoading"}},[n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(t,e){return n("article-item",{key:e,attrs:{article:t}})})),1)],1)],1)},b=[],g=n("2909"),_=n("2423"),w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("van-cell",{staticClass:"aticle-item",attrs:{to:{name:"article",params:{articleId:t.article.art_id}}}},[n("div",{staticClass:"title van-multi-ellipsis--l3",attrs:{slot:"title"},slot:"title"},[t._v(" "+t._s(t.article.title)+" ")]),n("div",{staticClass:"label",attrs:{slot:"label"},slot:"label"},[3===t.article.cover.type?n("div",{staticClass:"img-wrap"},t._l(t.article.cover.images,(function(t,e){return n("div",{key:e,staticClass:"img-item"},[n("van-image",{staticClass:"item",attrs:{fit:"cover",src:t}})],1)})),0):t._e(),n("div",{staticClass:"bottom-wrap"},[n("span",[t._v(t._s(t.article.aut_name))]),n("span",[t._v(t._s(t.article.comm_count)+"评论")]),n("span",[t._v(t._s(t._f("relativeTime")(t.article.pubdate)))])])]),1===t.article.cover.type?n("van-image",{staticClass:"image",attrs:{fit:"cover",src:t.article.cover.images[0]}}):t._e()],1)},C=[],E={name:"ArticleItem",components:{},props:{article:{type:Object,default:function(){return{}}}},data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{}},O=E,j=(n("d99f"),Object(d["a"])(O,w,C,!1,null,"f841ecc6",null)),x=j.exports,k=n("2ef0"),S={name:"ArticleList",components:{ArticleItem:x},props:{channel:{type:Object,default:function(){return{}}}},data:function(){return{list:[],loading:!1,finished:!1,timestamp:null,isRefreshLoading:!1,refreshSuccessText:"",scroll:0}},computed:{},watch:{},created:function(){},mounted:function(){var t=this,e=this.$refs["article-list"];e.addEventListener("scroll",Object(k["debounce"])((function(){t.scroll=e.scrollTop}),50))},activated:function(){this.$refs["article-list"].scrollTop=this.scroll},deactivated:function(){},methods:{onLoad:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,a,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(_["f"])({channel_id:t.channel.id,timestamp:t.timestamp||Date.now(),with_top:1});case 2:a=e.sent,r=a.data,i=r.data.results,(n=t.list).push.apply(n,Object(g["a"])(i)),t.loading=!1,i.length?t.timestamp=r.data.pre_timestamp:t.finished=!0;case 8:case"end":return e.stop()}}),e)})))()},onRefresh:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,a,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(_["f"])({channel_id:t.channel.id,timestamp:Date.now(),with_top:1});case 2:a=e.sent,r=a.data,i=r.data.results,(n=t.list).unshift.apply(n,Object(g["a"])(i)),t.isRefreshLoading=!1,t.refreshSuccessText="更新了".concat(i.length,"条数据");case 8:case"end":return e.stop()}}),e)})))()}}},T=S,A=(n("351c"),Object(d["a"])(T,v,b,!1,null,"776a5e74",null)),y=A.exports,I={name:"HomeTab",components:{ArticleList:y},props:{channels:{type:Array,default:function(){return[]}}},data:function(){return{active:0}},computed:{},watch:{},created:function(){var t=this;this.$bus.$on("updateActive",(function(e){t.active=e}))},mounted:function(){},methods:{isPopup:function(){this.$emit("isPopup"),this.$bus.$emit("gaoLiangShow",this.active)}}},R=I,L=(n("655b"),Object(d["a"])(R,p,m,!1,null,"0660f73a",null)),N=L.exports,$=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("van-popup",{style:{height:"100%"},attrs:{closeable:"","close-icon-position":"top-left",position:"bottom","get-container":"body"},on:{click:t.popup},model:{value:t.isShow,callback:function(e){t.isShow=e},expression:"isShow"}},[t._t("default")],2)},P=[],G={name:"Popup",components:{},props:{isChannelEditShow:{type:Boolean}},data:function(){return{isShow:!1}},computed:{},watch:{isChannelEditShow:function(t){this.isShow=t}},created:function(){},mounted:function(){},methods:{popup:function(){this.$emit("popup",this.isShow)}}},H=G,D=(n("0ce5"),Object(d["a"])(H,$,P,!1,null,"06330112",null)),F=D.exports,U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"channel-edit"},[n("van-cell",{staticClass:"cell",attrs:{center:"",border:!1}},[n("div",{staticClass:"channel-title",attrs:{slot:"title"},slot:"title"},[t._v("我的频道")]),n("van-button",{attrs:{type:"warning",plain:"",round:"",size:"mini"},on:{click:function(e){t.isEdit=!t.isEdit}}},[t._v(t._s(t.isEdit?"完成":"编辑"))])],1),n("van-grid",{attrs:{gutter:10}},t._l(t.userChannels,(function(e,a){return n("van-grid-item",{key:a,staticClass:"grid-item",class:{active:a===t.gaoLiangShow},attrs:{icon:t.isEdit&&0!==a?"clear":"",text:e.name},on:{click:function(n){return t.onUserChannelClick(e,a)}}})})),1),n("van-cell",{staticClass:"cell cell-bottom",attrs:{center:"",border:!1}},[n("div",{staticClass:"channel-title",attrs:{slot:"title"},slot:"title"},[t._v("频道推荐")])]),n("van-grid",{attrs:{gutter:10}},t._l(t.recommendChannels,(function(e,a){return n("van-grid-item",{key:a,attrs:{text:e.name},on:{click:function(n){return t.onAdd(e)}}})})),1)],1)},M=[],V=(n("a9e3"),n("4de4"),n("7db0"),n("a434"),n("b775")),z=function(){return Object(V["a"])({method:"get",url:"/app/v1_0/channels"})},B=function(t){return Object(V["a"])({url:"/app/v1_0/user/channels",method:"PATCH",data:t})},J=function(t){return Object(V["a"])({url:"/app/v1_0/user/channels/".concat(t),method:"DELETE"})},X=n("2f62"),Y=n("5d2d"),q={name:"ChannelEdit",components:{},props:{channelsEdit:{type:Array,default:function(){return[]}},active:{type:Number,default:0}},data:function(){return{allChannels:[],userChannels:[],isEdit:!1,gaoLiangShow:0}},computed:Object(c["a"])(Object(c["a"])({},Object(X["b"])(["user"])),{},{recommendChannels:function(){var t=this;return this.allChannels.filter((function(e){return!t.userChannels.find((function(t){return t.id===e.id}))}))}}),watch:{channelsEdit:{handler:function(t){this.userChannels=t},immediate:!0}},created:function(){var t=this;this._getAllChannels(),this.$bus.$on("gaoLiangShow",(function(e){t.gaoLiangShow=e}))},mounted:function(){},methods:{_getAllChannels:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,z();case 2:n=e.sent,a=n.data,t.allChannels=a.data.channels;case 5:case"end":return e.stop()}}),e)})))()},onAdd:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.userChannels.push(t),!e.user){n.next=6;break}return n.next=4,B({channels:[{id:t.id,seq:e.userChannels.length}]});case 4:n.next=7;break;case 6:Object(Y["b"])("user-channels",e.userChannels);case 7:case"end":return n.stop()}}),n)})))()},onUserChannelClick:function(t,e){this.isEdit&&0!==e?this.deleteChannel(t,e):this.switchChannel(e)},deleteChannel:function(t,e){var n=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n.userChannels.splice(e,1),!n.user){a.next=6;break}return a.next=4,J(t.id);case 4:a.next=7;break;case 6:Object(Y["b"])("user-channels",n.userChannels);case 7:case"end":return a.stop()}}),a)})))()},switchChannel:function(t){this.$emit("close"),this.$bus.$emit("updateActive",t)}}},K=q,Q=(n("f87d"),Object(d["a"])(K,U,M,!1,null,"7c886018",null)),W=Q.exports,Z=n("c24f"),tt={name:"Home",components:{HomeNavBar:h,HomeTab:N,Popup:F,ChannelEdit:W},props:{},data:function(){return{channels:[],isChannelEditShow:!1}},computed:Object(c["a"])({},Object(X["b"])(["user"])),watch:{},created:function(){this._getUserChannels()},mounted:function(){},methods:{_getUserChannels:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,a,r,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=[],!t.user){e.next=9;break}return e.next=4,Object(Z["d"])();case 4:a=e.sent,r=a.data,n=r.data.channels,e.next=18;break;case 9:if(!window.localStorage.getItem("user-channels")){e.next=13;break}n=Object(Y["a"])("user-channels"),e.next=18;break;case 13:return e.next=15,Object(Z["d"])();case 15:i=e.sent,c=i.data,n=c.data.channels;case 18:t.channels=n;case 19:case"end":return e.stop()}}),e)})))()},isPopup:function(){this.isChannelEditShow=!0},popup:function(t){this.isChannelEditShow=t}}},et=tt,nt=Object(d["a"])(et,a,r,!1,null,"63f374df",null);e["default"]=nt.exports},c1ad:function(t,e,n){},c24f:function(t,e,n){"use strict";n.d(e,"e",(function(){return r})),n.d(e,"f",(function(){return i})),n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return s})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return u})),n.d(e,"i",(function(){return l})),n.d(e,"h",(function(){return d})),n.d(e,"g",(function(){return f}));var a=n("b775"),r=function(t){return Object(a["a"])({method:"POST",url:"/app/v1_0/authorizations",data:t})},i=function(t){return Object(a["a"])({url:"/app/v1_0/sms/codes/".concat(t),method:"GET"})},c=function(){return Object(a["a"])({url:"/app/v1_0/user",method:"GET"})},s=function(){return Object(a["a"])({url:"/app/v1_0/user/channels",method:"GET"})},o=function(t){return Object(a["a"])({method:"POST",url:"/app/v1_0/user/followings",data:{target:t}})},u=function(t){return Object(a["a"])({method:"DELETE",url:"/app/v1_0/user/followings/".concat(t)})},l=function(){return Object(a["a"])({method:"GET",url:"/app/v1_0/user/profile"})},d=function(t){return Object(a["a"])({method:"PATCH",url:"/app/v1_0/user/profile",data:t})},f=function(t){return Object(a["a"])({method:"PATCH",url:"/app/v1_0/user/photo",data:t})}},c2fb:function(t,e,n){},d99f:function(t,e,n){"use strict";n("4d3d")},f40a:function(t,e,n){},f87d:function(t,e,n){"use strict";n("6009")}}]);
//# sourceMappingURL=chunk-3054f6c8.06fdc90f.js.map